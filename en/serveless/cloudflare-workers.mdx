---
title: "Send with Cloudflare Workers"
description: "Send SMS with Rewrite from a Cloudflare Worker."
---

This guide shows how to send SMS using Rewrite inside a **Cloudflare Worker**.

## 1. Install the SDK

```bash
npm install @rewritejs/sdk
```

## 2. Configure environment variables

Set your API key in `wrangler.toml` secrets:

```bash
wrangler secret put REWRITE_API_KEY
```

## 3. Create the worker

```ts src/index.ts
import { Rewrite } from '@rewritejs/sdk';

export interface Env {
  REWRITE_API_KEY: string;
}

export default {
  async fetch(request: Request, env: Env): Promise<Response> {
    if (request.method !== 'POST') {
      return Response.json({ error: 'Method not allowed' }, { status: 405 });
    }

    const rewrite = new Rewrite(env.REWRITE_API_KEY);
    const body = await request.json().catch(() => ({}));
    const { to, message } = body as { to?: string; message?: string };

    if (!to || !message) {
      return Response.json(
        { error: '`to` and `message` are required' },
        { status: 400 }
      );
    }

    const { data, error } = await rewrite.messages.send({
      to,
      message,
      metadata: { source: 'cloudflare-worker' },
    });

    if (error) {
      return Response.json({ error }, { status: 422 });
    }

    return Response.json({ data }, { status: 200 });
  },
};
```

## 4. Test locally

```bash
curl -X POST "http://127.0.0.1:8787" \
  -H "Content-Type: application/json" \
  -d '{
    "to": "+15551234567",
    "message": "Hello from Cloudflare + Rewrite"
  }'
```

## 5. Deploy

```bash
wrangler deploy
```

<Info>
Workers are ideal for low-latency edge-triggered sends, but you should still add retries and idempotency in your app layer.
</Info>

